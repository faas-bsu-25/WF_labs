[gd_scene load_steps=23 format=3 uid="uid://rr8iro5nd7ah"]

[ext_resource type="Script" uid="uid://dh3wr3ejcveun" path="res://lab7-Beatemup/beu_player.gd" id="1_d4gc0"]
[ext_resource type="Texture2D" uid="uid://6nc1ubdbvj80" path="res://lab7-Beatemup/adventurer-1.3-Sheet.png" id="2_d4gc0"]
[ext_resource type="Script" uid="uid://b5jjps2egeol4" path="res://lab7-Beatemup/badnik.gd" id="3_23835"]
[ext_resource type="Texture2D" uid="uid://dxip68rwtglp3" path="res://lab3-shoot/sprites/enemyBlack4.png" id="4_qxi31"]

[sub_resource type="CapsuleShape2D" id="CapsuleShape2D_23835"]

[sub_resource type="Animation" id="Animation_d4gc0"]
resource_name = "Idle"
length = 1.2
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("BEUPlayer/Sprite2D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.133333, 0.3, 0.466667),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 1,
"values": [0, 2, 0, 3]
}

[sub_resource type="Animation" id="Animation_5qo43"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("BEUPlayer/Sprite2D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [1]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("BEUPlayer/attackRegion:process_mode")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [4]
}

[sub_resource type="Animation" id="Animation_23835"]
resource_name = "walk"
step = 0.1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("BEUPlayer/Sprite2D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.1, 0.2, 0.3, 0.5, 0.6, 0.7),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [8, 8, 10, 9, 11, 12, 13]
}

[sub_resource type="Animation" id="Animation_qxi31"]
resource_name = "attack"
length = 0.9
step = 0.1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("BEUPlayer/Sprite2D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.2, 0.4, 0.6),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 1,
"values": [49, 50, 51, 52]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("BEUPlayer/attackRegion:process_mode")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.190928, 0.785407),
"transitions": PackedFloat32Array(1, 1, 1),
"update": 1,
"values": [4, 0, 4]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_23835"]
_data = {
&"Idle": SubResource("Animation_d4gc0"),
&"RESET": SubResource("Animation_5qo43"),
&"attack": SubResource("Animation_qxi31"),
&"walk": SubResource("Animation_23835")
}

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_1cwvx"]
animation = &"Idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_eh3ao"]
animation = &"attack"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_uoatj"]
animation = &"walk"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_lsfln"]
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_1ecah"]
advance_mode = 2
advance_condition = &"walk"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_rqu5x"]
advance_mode = 2
advance_condition = &"attack"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_omrut"]
advance_mode = 2
advance_condition = &"Idle"

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_e0rl7"]
switch_mode = 2
advance_mode = 2

[sub_resource type="AnimationNodeStateMachineTransition" id="AnimationNodeStateMachineTransition_uj5lc"]
advance_mode = 2
advance_condition = &"attack"

[sub_resource type="AnimationNodeStateMachine" id="AnimationNodeStateMachine_idn40"]
states/End/position = Vector2(747, 84)
states/Idle/node = SubResource("AnimationNodeAnimation_1cwvx")
states/Idle/position = Vector2(359, 84)
states/Start/position = Vector2(195, 84)
states/attack/node = SubResource("AnimationNodeAnimation_eh3ao")
states/attack/position = Vector2(484, 199)
states/walk/node = SubResource("AnimationNodeAnimation_uoatj")
states/walk/position = Vector2(602, 84)
transitions = ["Start", "Idle", SubResource("AnimationNodeStateMachineTransition_lsfln"), "Idle", "walk", SubResource("AnimationNodeStateMachineTransition_1ecah"), "Idle", "attack", SubResource("AnimationNodeStateMachineTransition_rqu5x"), "walk", "Idle", SubResource("AnimationNodeStateMachineTransition_omrut"), "attack", "Idle", SubResource("AnimationNodeStateMachineTransition_e0rl7"), "walk", "attack", SubResource("AnimationNodeStateMachineTransition_uj5lc")]
graph_offset = Vector2(-125.703, 3)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_d4gc0"]
size = Vector2(26.25, 30.5)

[sub_resource type="CapsuleShape2D" id="CapsuleShape2D_1cwvx"]

[node name="Beatemup" type="Node2D"]

[node name="BEUPlayer" type="CharacterBody2D" parent="."]
position = Vector2(333, 266)
scale = Vector2(4, 4)
script = ExtResource("1_d4gc0")
metadata/_edit_group_ = true

[node name="CollisionShape2D" type="CollisionShape2D" parent="BEUPlayer"]
shape = SubResource("CapsuleShape2D_23835")

[node name="Sprite2D" type="Sprite2D" parent="BEUPlayer"]
position = Vector2(-4, -4)
texture = ExtResource("2_d4gc0")
hframes = 8
vframes = 12
frame = 1

[node name="AnimationPlayer" type="AnimationPlayer" parent="BEUPlayer"]
root_node = NodePath("../..")
libraries = {
&"": SubResource("AnimationLibrary_23835")
}
autoplay = "Idle"

[node name="AnimationTree" type="AnimationTree" parent="BEUPlayer"]
root_node = NodePath("../..")
tree_root = SubResource("AnimationNodeStateMachine_idn40")
anim_player = NodePath("../AnimationPlayer")
parameters/conditions/Idle = false
parameters/conditions/attack = false
parameters/conditions/walk = false

[node name="attackRegion" type="Area2D" parent="BEUPlayer"]
process_mode = 4
position = Vector2(12.5, -1.25)

[node name="CollisionShape2D" type="CollisionShape2D" parent="BEUPlayer/attackRegion"]
position = Vector2(3.125, 0.75)
shape = SubResource("RectangleShape2D_d4gc0")

[node name="Badnik" type="CharacterBody2D" parent="." groups=["enemy"]]
position = Vector2(608, 269)
scale = Vector2(4, 4)
script = ExtResource("3_23835")

[node name="CollisionShape2D" type="CollisionShape2D" parent="Badnik"]
shape = SubResource("CapsuleShape2D_1cwvx")

[node name="Sprite2D" type="Sprite2D" parent="Badnik"]
position = Vector2(4.05312e-06, 1.25)
scale = Vector2(0.224085, 0.239583)
texture = ExtResource("4_qxi31")

[node name="ProgressBar" type="ProgressBar" parent="Badnik"]
offset_left = -21.25
offset_top = -47.5
offset_right = 24.75
offset_bottom = -20.5
max_value = 5.0
value = 5.0
show_percentage = false

[connection signal="body_entered" from="BEUPlayer/attackRegion" to="BEUPlayer" method="_on_attack_region_body_entered"]
